<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Produtos</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        input { margin: 5px; }
        button { margin: 5px; }
    </style>
</head>
<body>
    <h1>Cadastro de Produtos</h1>

    <input type="hidden" id="id">
    <input type="text" id="name" placeholder="Nome">
    <input type="text" id="description" placeholder="Descrição">
    <input type="number" id="price" placeholder="Preço">
    <button onclick="salvarProduto()">Salvar</button>

    <h2>Lista de Produtos</h2>
    <table border="1" cellpadding="5">
        <thead>
            <tr><th>ID</th><th>Nome</th><th>Descrição</th><th>Preço</th><th>Ações</th></tr>
        </thead>
        <tbody id="productTable"></tbody>
    </table>

    <script>
        const api = 'http://localhost:8080/products';

        function carregarProdutos() {
            fetch(api)
                .then(res => res.json())
                .then(data => {
                    const table = document.getElementById('productTable');
                    table.innerHTML = '';
                    data.forEach(prod => {
                        table.innerHTML += `
                            <tr>
                                <td>${prod.id}</td>
                                <td>${prod.name}</td>
                                <td>${prod.description}</td>
                                <td>${prod.price}</td>
                                <td>
                                    <button onclick='editarProduto(${JSON.stringify(prod)})'>Editar</button>
                                    <button onclick='deletarProduto(${prod.id})'>Excluir</button>
                                </td>
                            </tr>`;
                    });
                });
        }

        function salvarProduto() {
            const id = document.getElementById('id').value;
            const produto = {
                name: document.getElementById('name').value,
                description: document.getElementById('description').value,
                price: parseFloat(document.getElementById('price').value)
            };

            const method = id ? 'PUT' : 'POST';
            const url = id ? `${api}/${id}` : api;

            fetch(url, {
                method,
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(produto)
            }).then(() => {
                document.getElementById('id').value = '';
                document.getElementById('name').value = '';
                document.getElementById('description').value = '';
                document.getElementById('price').value = '';
                carregarProdutos();
            });
        }

        function editarProduto(prod) {
            document.getElementById('id').value = prod.id;
            document.getElementById('name').value = prod.name;
            document.getElementById('description').value = prod.description;
            document.getElementById('price').value = prod.price;
        }

        function deletarProduto(id) {
            fetch(`${api}/${id}`, { method: 'DELETE' })
                .then(() => carregarProdutos());
        }

        carregarProdutos();
    </script>
</body>
</html>
